<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í†µê³„ - <%= shortCode %> | ShotLink</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“Š ë§í¬ í†µê³„</h1>
            <p><code><%= shortCode %></code> ì½”ë“œì˜ ìƒì„¸ ì •ë³´</p>
            <div class="nav-buttons">
                <a href="/" class="nav-btn">ğŸ”— í™ˆìœ¼ë¡œ</a>
                <a href="/my-links" class="nav-btn">ğŸ“‹ ë‚´ ë§í¬ë“¤</a>
            </div>
        </header>

        <main>
            <div class="stats-container">
                <div class="stats-header">
                    <h2>ğŸ¯ ë§í¬ ì •ë³´</h2>
                    <div class="short-code-display">
                        <span class="code-label">ë‹¨ì¶• ì½”ë“œ:</span>
                        <code class="short-code"><%= shortCode %></code>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card main-stat">
                        <div class="stat-icon">ğŸ‘†</div>
                        <div class="stat-content">
                            <h3>ì´ í´ë¦­ ìˆ˜</h3>
                            <div class="big-number"><%= clicks %></div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon">ğŸ“…</div>
                        <div class="stat-content">
                            <h3>ìƒì„± ì¼ì‹œ</h3>
                            <div class="stat-value">
                                <%= new Date(createdAt).toLocaleDateString('ko-KR', { 
                                    year: 'numeric', 
                                    month: 'long', 
                                    day: 'numeric'
                                }) %>
                            </div>
                            <div class="stat-sub">
                                <%= new Date(createdAt).toLocaleTimeString('ko-KR') %>
                            </div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon">â±ï¸</div>
                        <div class="stat-content">
                            <h3>ìƒì„± í›„ ê²½ê³¼</h3>
                            <div class="stat-value" id="elapsed-time">
                                ê³„ì‚° ì¤‘...
                            </div>
                        </div>
                    </div>
                </div>

                <div class="url-info">
                    <h3>ğŸ”— URL ì •ë³´</h3>
                    
                    <div class="url-section">
                        <label>ë‹¨ì¶• URL:</label>
                        <div class="url-display">
                            <input type="text" value="<%= shortUrl %>" readonly class="url-input-readonly" id="shortUrlInput">
                            <button onclick="copyUrl('<%= shortUrl %>')" class="copy-btn-small">ë³µì‚¬</button>
                        </div>
                        <div class="url-actions">
                            <a href="<%= shortUrl %>" target="_blank" class="visit-btn">ğŸš€ ë°©ë¬¸í•˜ê¸°</a>
                        </div>
                    </div>

                    <div class="url-section">
                        <label>ì›ë³¸ URL:</label>
                        <div class="original-url-display">
                            <a href="<%= originalUrl %>" target="_blank" class="original-link-full">
                                <%= originalUrl %>
                            </a>
                        </div>
                    </div>
                </div>

                <div class="performance-info">
                    <h3>ğŸ“ˆ ì„±ê³¼ ë¶„ì„</h3>
                    <div class="performance-grid">
                        <div class="performance-card">
                            <div class="perf-label">ì¼ì¼ í‰ê·  í´ë¦­</div>
                            <div class="perf-value" id="daily-avg">ê³„ì‚° ì¤‘...</div>
                        </div>
                        <div class="performance-card">
                            <div class="perf-label">ë§í¬ ìƒíƒœ</div>
                            <div class="perf-value">
                                <span class="status-active">ğŸŸ¢ í™œì„±</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <footer>
            <p>ê°„ë‹¨í•˜ê³  ë¹ ë¥¸ URL ë‹¨ì¶• ì„œë¹„ìŠ¤ | ShotLink</p>
        </footer>
    </div>

    <script>
        function copyUrl(url) {
            navigator.clipboard.writeText(url).then(function() {
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = 'ë³µì‚¬ë¨!';
                btn.style.background = '#27ae60';
                
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = '';
                }, 2000);
            }).catch(function() {
                const input = document.createElement('input');
                input.value = url;
                document.body.appendChild(input);
                input.select();
                document.execCommand('copy');
                document.body.removeChild(input);
                
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = 'ë³µì‚¬ë¨!';
                btn.style.background = '#27ae60';
                
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = '';
                }, 2000);
            });
        }

        function calculateElapsedTime() {
            const createdAt = new Date('<%= createdAt %>');
            const now = new Date();
            const diffMs = now - createdAt;
            
            const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
            const diffHours = Math.floor((diffMs % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const diffMinutes = Math.floor((diffMs % (1000 * 60 * 60)) / (1000 * 60));
            
            let elapsedText = '';
            if (diffDays > 0) {
                elapsedText += diffDays + 'ì¼ ';
            }
            if (diffHours > 0) {
                elapsedText += diffHours + 'ì‹œê°„ ';
            }
            if (diffMinutes > 0) {
                elapsedText += diffMinutes + 'ë¶„';
            }
            if (elapsedText === '') {
                elapsedText = 'ë°©ê¸ˆ ì „';
            }
            
            document.getElementById('elapsed-time').textContent = elapsedText;
            
            const totalDays = diffDays || 1;
            const dailyAvg = (<%= clicks %> / totalDays).toFixed(1);
            document.getElementById('daily-avg').textContent = dailyAvg + ' íšŒ';
        }

        calculateElapsedTime();
        setInterval(calculateElapsedTime, 60000);
    </script>
</body>
</html>